

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mgkit.workflow.filter_gff module &mdash; MGKit: Metagenomic framework 0.5.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mgkit.workflow.hmmer2gff module" href="mgkit.workflow.hmmer2gff.html" />
    <link rel="prev" title="mgkit.workflow.fastq_utils module" href="mgkit.workflow.fastq_utils.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MGKit: Metagenomic framework
          

          
          </a>

          
            
            
              <div class="version">
                0.5.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline/index.html">Metagenomic Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff.html">MGKit GFF Specifications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../library.html">Library Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mgkit.html">mgkit package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.align.html">mgkit.align module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.consts.html">mgkit.consts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.counts.html">mgkit.counts package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.counts.func.html">mgkit.counts.func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.counts.glm.html">mgkit.counts.glm module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.counts.scaling.html">mgkit.counts.scaling module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.db.html">mgkit.db package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.db.dbm.html">mgkit.db.dbm module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.db.mongo.html">mgkit.db.mongo module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.filter.html">mgkit.filter package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.filter.common.html">mgkit.filter.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.filter.gff.html">mgkit.filter.gff module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.filter.lists.html">mgkit.filter.lists module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.filter.reads.html">mgkit.filter.reads module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.filter.taxon.html">mgkit.filter.taxon module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.graphs.html">mgkit.graphs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.html">mgkit.io package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.blast.html">mgkit.io.blast module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.fasta.html">mgkit.io.fasta module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.fastq.html">mgkit.io.fastq module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.gff.html">mgkit.io.gff module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.glimmer.html">mgkit.io.glimmer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.snpdat.html">mgkit.io.snpdat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.uniprot.html">mgkit.io.uniprot module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.io.utils.html">mgkit.io.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.kegg.html">mgkit.kegg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.logger.html">mgkit.logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.html">mgkit.mappings package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.cazy.html">mgkit.mappings.cazy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.eggnog.html">mgkit.mappings.eggnog module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.enzyme.html">mgkit.mappings.enzyme module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.go.html">mgkit.mappings.go module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.pandas_map.html">mgkit.mappings.pandas_map module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.taxon.html">mgkit.mappings.taxon module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.mappings.utils.html">mgkit.mappings.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.net.html">mgkit.net package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.net.embl.html">mgkit.net.embl module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.net.pfam.html">mgkit.net.pfam module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.net.uniprot.html">mgkit.net.uniprot module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.net.utils.html">mgkit.net.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.html">mgkit.plots package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.abund.html">mgkit.plots.abund module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.boxplot.html">mgkit.plots.boxplot module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.colors.html">mgkit.plots.colors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.heatmap.html">mgkit.plots.heatmap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.unused.html">mgkit.plots.unused module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.plots.utils.html">mgkit.plots.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.simple_cache.html">mgkit.simple_cache module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.snps.html">mgkit.snps package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.snps.classes.html">mgkit.snps.classes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.snps.conv_func.html">mgkit.snps.conv_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.snps.filter.html">mgkit.snps.filter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.snps.funcs.html">mgkit.snps.funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.snps.mapper.html">mgkit.snps.mapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.taxon.html">mgkit.taxon module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.utils.html">mgkit.utils package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.utils.common.html">mgkit.utils.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.utils.dictionary.html">mgkit.utils.dictionary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.utils.sequence.html">mgkit.utils.sequence module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.utils.trans_tables.html">mgkit.utils.trans_tables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.html">mgkit.workflow package</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.add_gff_info.html">mgkit.workflow.add_gff_info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.blast2gff.html">mgkit.workflow.blast2gff module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.extract_gff_info.html">mgkit.workflow.extract_gff_info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.fasta_utils.html">mgkit.workflow.fasta_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.fastq_utils.html">mgkit.workflow.fastq_utils module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">mgkit.workflow.filter_gff module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#value-filtering">Value Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overlap-filtering">Overlap Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#per-sequence-values">Per Sequence Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coverage-filtering">Coverage Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changes">Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.hmmer2gff.html">mgkit.workflow.hmmer2gff module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.json2gff.html">mgkit.workflow.json2gff module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.sampling_utils.html">mgkit.workflow.sampling_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.snp_parser.html">mgkit.workflow.snp_parser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.taxon_utils.html">mgkit.workflow.taxon_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgkit.workflow.utils.html">mgkit.workflow.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">mgkit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MGKit: Metagenomic framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../library.html">Library Reference</a> &raquo;</li>
        
          <li><a href="mgkit.html">mgkit package</a> &raquo;</li>
        
          <li><a href="mgkit.workflow.html">mgkit.workflow package</a> &raquo;</li>
        
      <li>mgkit.workflow.filter_gff module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/mgkit.workflow.filter_gff.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-mgkit.workflow.filter_gff">
<span id="mgkit-workflow-filter-gff-module"></span><h1>mgkit.workflow.filter_gff module<a class="headerlink" href="#module-mgkit.workflow.filter_gff" title="Permalink to this headline">¶</a></h1>
<p>Filters GFF annotations in different ways.</p>
<div class="section" id="value-filtering">
<h2>Value Filtering<a class="headerlink" href="#value-filtering" title="Permalink to this headline">¶</a></h2>
<p>Enables filtering of GFF annotations based on the the values of attributes of a
GFF annotation. The filters are based on equality of numbers (internally
converted into float) and strings, a string contained in the value of an attribute
less or greater than are included as well. The length of annotation has the
attribute <em>length</em> and can be tested.</p>
</div>
<div class="section" id="overlap-filtering">
<h2>Overlap Filtering<a class="headerlink" href="#overlap-filtering" title="Permalink to this headline">¶</a></h2>
<p>Filters overlapping annotations using the functions
<a class="reference internal" href="mgkit.filter.gff.html#mgkit.filter.gff.choose_annotation" title="mgkit.filter.gff.choose_annotation"><code class="xref py py-func docutils literal notranslate"><span class="pre">mgkit.filter.gff.choose_annotation()</span></code></a> and
<a class="reference internal" href="mgkit.filter.gff.html#mgkit.filter.gff.filter_annotations" title="mgkit.filter.gff.filter_annotations"><code class="xref py py-func docutils literal notranslate"><span class="pre">mgkit.filter.gff.filter_annotations()</span></code></a>, after the annotations are grouped
by both sequence and strand. If the GFF is sorted by sequence name and strand,
the <cite>-t</cite> can be used to make the filtering use less memory. It can be sorted in
Unix using <cite>sort -s -k 1,1 -k 7,7 gff_file</cite>, which applies a stable sort using
the sequence name as the first key and the strand as the second key.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is also recommended to use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="n">C</span>
</pre></div>
</div>
<p>To speed up the sorting</p>
</div>
<div><svg height="440" viewBox="0 0 592 440" width="592" xmlns="http://www.w3.org/2000/svg" xmlns:inkspace="http://www.inkscape.org/namespaces/inkscape" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs id="defs_block">
    <filter height="1.504" id="filter_blur" inkspace:collect="always" width="1.1575" x="-0.07875" y="-0.252">
      <feGaussianBlur id="feGaussianBlur3780" inkspace:collect="always" stdDeviation="4.2" />
    </filter>
  </defs>
  <title>blockdiag</title>
  <desc />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="128" x="103" y="206" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="200" x="331" y="206" />
  <polygon fill="rgb(0,0,0)" points="91,46 267,46 243,86 67,86 91,46" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="200" x="67" y="126" />
  <polygon fill="rgb(0,0,0)" points="167,278 275,306 167,334 59,306 167,278" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="200" x="75" y="374" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="200" x="71" y="370" />
  <rect fill="rgb(0,0,0)" height="40" stroke="rgb(0,0,0)" style="filter:url(#filter_blur);opacity:0.7;fill-opacity:1" width="200" x="67" y="366" />
  <rect fill="rgb(55,126,184)" height="40" stroke="rgb(0,0,0)" width="128" x="100" y="200" />
  <text fill="rgb(255,255,255)" font-family="sans-serif" font-size="15" font-style="normal" font-weight="normal" text-anchor="middle" textLength="32" x="164.0" y="227">sort</text>
  <rect fill="rgb(228,26,28)" height="40" stroke="rgb(0,0,0)" width="200" x="328" y="200" />
  <text fill="rgb(255,255,255)" font-family="sans-serif" font-size="15" font-style="normal" font-weight="normal" text-anchor="middle" textLength="139" x="428.5" y="227">group_annotations</text>
  <polygon fill="rgb(77,175,74)" points="88,40 264,40 240,80 64,80 88,40" stroke="rgb(0,0,0)" />
  <text fill="rgb(255,255,255)" font-family="sans-serif" font-size="15" font-style="normal" font-weight="normal" text-anchor="middle" textLength="24" x="164.0" y="67">GFF</text>
  <rect fill="rgb(228,26,28)" height="40" stroke="rgb(0,0,0)" width="200" x="64" y="120" />
  <text fill="rgb(255,255,255)" font-family="sans-serif" font-size="15" font-style="normal" font-weight="normal" text-anchor="middle" textLength="73" x="164.5" y="147">parse_gff</text>
  <polygon fill="rgb(228,26,28)" points="164,272 272,300 164,328 56,300 164,272" stroke="rgb(0,0,0)" />
  <text fill="rgb(255,255,255)" font-family="sans-serif" font-size="12" font-style="normal" font-weight="normal" text-anchor="middle" textLength="104" x="164.0" y="306">filter_annot ...</text>
  <rect fill="rgb(77,175,74)" height="40" stroke="rgb(0,0,0)" width="200" x="72" y="368" />
  <rect fill="rgb(77,175,74)" height="40" stroke="rgb(0,0,0)" width="200" x="68" y="364" />
  <rect fill="rgb(77,175,74)" height="40" stroke="rgb(0,0,0)" width="200" x="64" y="360" />
  <text fill="rgb(255,255,255)" font-family="sans-serif" font-size="15" font-style="normal" font-weight="normal" text-anchor="middle" textLength="163" x="164.5" y="387">Filtered Annotations</text>
  <path d="M 164 240 L 164 264" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="164,271 160,264 168,264 164,271" stroke="rgb(0,0,0)" />
  <path d="M 164 80 L 164 112" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="164,119 160,112 168,112 164,119" stroke="rgb(0,0,0)" />
  <path d="M 164 160 L 164 192" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="164,199 160,192 168,192 164,199" stroke="rgb(0,0,0)" />
  <path d="M 164 160 L 164 180" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 164 180 L 428 180" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 428 180 L 428 192" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="428,199 424,192 432,192 428,199" stroke="rgb(0,0,0)" />
  <path d="M 428 240 L 428 260" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 164 260 L 428 260" fill="none" stroke="rgb(0,0,0)" />
  <path d="M 164 260 L 164 264" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="164,271 160,264 168,264 164,271" stroke="rgb(0,0,0)" />
  <path d="M 164 328 L 164 352" fill="none" stroke="rgb(0,0,0)" />
  <polygon fill="rgb(0,0,0)" points="164,359 160,352 168,352 164,359" stroke="rgb(0,0,0)" />
</svg>
</div>
<p>The above digram describes the internals of the script.</p>
<p>The annotations needs first to be grouped by seq_id and strand, forming a group
that can be then be passed to <a class="reference internal" href="mgkit.filter.gff.html#mgkit.filter.gff.filter_annotations" title="mgkit.filter.gff.filter_annotations"><code class="xref py py-func docutils literal notranslate"><span class="pre">mgkit.filter.gff.filter_annotations()</span></code></a>.
This function:</p>
<blockquote>
<div><ol class="arabic">
<li><p>sort annotations by bit score, from the highest to the lowest</p></li>
<li><p>loop over all combination of N=2 annotations:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>choose which of the two annotations to discard if they overlap for a
the required amount of bp (defaults to 100bp)</p></li>
<li><p>in which case, the preference is given to the db quality first, than
the bit score and finally the lenght of annotation, the one with the
highest values is kept</p></li>
</ol>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>While the default behaviour is the same, now it is posible to decided the
function used to discard one the two annotations. It is possible to use the
<cite>-c</cite> argument to pass a string that defines the function. The string passed must
start with or without a <strong>+</strong>. Using <strong>+</strong> translates into the builtin function
<em>max</em> while no <strong>+</strong> translates into <em>min</em> from the second character on, any
number of attributes can be used, separated by commas. The attributes, however,
must be one of the properties defined in <a class="reference internal" href="mgkit.io.gff.html#mgkit.io.gff.Annotation" title="mgkit.io.gff.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">mgkit.io.gff.Annotation</span></code></a>,
<em>bitscore</em> that returns the value converted in a <em>float</em>. Internally the
attributes are stored as strings, so for attributes that have no properties in
the class, such as <em>evalue</em>, the <cite>float</cite> builtin is applied.</p>
<p>The tuples built for both annotations are then passed to the comparison
function to be selected and the value returned by it is <strong>discarded</strong>. The
order of the elements in the string is important to define the priority
given to each element in the comparison and the leftmost one has the
highesst priority.</p>
<p>Examples of function strings:</p>
<ul class="simple">
<li><p><cite>-dbq,bitscore,length</cite> becomes max((ann1.dbq, ann1.bitscore, ann1.length),
(ann2.dbq, ann2.bitscore, ann2.length) - This is default and previously
only choice</p></li>
<li><p><cite>-bitscore,length,dbq</cite> uses the same elements but gives lowest priority
to <em>dbq</em></p></li>
<li><p><cite>+evalue</cite>: will discard the annotation with the highest <em>evalue</em></p></li>
</ul>
</div>
<div class="section" id="per-sequence-values">
<h2>Per Sequence Values<a class="headerlink" href="#per-sequence-values" title="Permalink to this headline">¶</a></h2>
<p>The <em>sequence</em> command allows to filter on a per sequence basis, using
functions such as the median, quantile and mean on attributes like evalue,
bitscore and identity. The file can be passed as sorted already, saving memory
(like in the <em>overlap</em> command), but it’s not needed to sort the file by strand,
only by the first column.</p>
</div>
<div class="section" id="coverage-filtering">
<h2>Coverage Filtering<a class="headerlink" href="#coverage-filtering" title="Permalink to this headline">¶</a></h2>
<p>The <em>cov</em> command calculates the coverage of annotations as a measure of the
percentage of each reference sequence length. A minimum coverage percentage can
be used to keep the annotations of sequences that have a greater or equal
coverage than the specified one.</p>
</div>
<div class="section" id="changes">
<h2>Changes<a class="headerlink" href="#changes" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.1.12.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.1.13: </span>added <em>–sorted</em> option</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.2.0: </span>changed option <em>-c</em> to accept a string to filter overlap</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.2.5: </span>added <em>sequence</em> command</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.2.6: </span>added <em>length</em> as attribute and <em>min</em>/<em>max</em>, and <em>ge</em> is the default
comparison for command <em>sequence</em>, <em>–sort-attr</em> to <em>overlap</em></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.3.1: </span>added <em>–num-gt</em> and <em>–num-lt</em> to <em>values</em> command, added <em>cov</em> command</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.3.4: </span>moved to use <em>click</em> for argument parsing reworked the <em>values</em>, <em>sequence</em>
commands</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.4.4: </span><em>overlap</em> command: added option to not use the strand information and
added an option to make multiple passes of overlap for each sequence</p>
</div>
<dl class="py function">
<dt id="mgkit.workflow.filter_gff.filter_eq">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">filter_eq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">conv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#filter_eq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.filter_eq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.filter_gt">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">filter_gt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">conv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">equal</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#filter_gt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.filter_gt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.filter_in">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">filter_in</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">conv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#filter_in"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.filter_in" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.filter_lt">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">filter_lt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotation</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">conv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">equal</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#filter_lt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.filter_lt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.find_comparison">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">find_comparison</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">comparison</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#find_comparison"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.find_comparison" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.make_choose_func">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">make_choose_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#make_choose_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.make_choose_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the function used to choose between two annotations.</p>
</dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.perseq_calc_threshold">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">perseq_calc_threshold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotations</span></em>, <em class="sig-param"><span class="n">attribute</span></em>, <em class="sig-param"><span class="n">function</span></em>, <em class="sig-param"><span class="n">func_arg</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#perseq_calc_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.perseq_calc_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.setup_filters">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">setup_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">str_eq</span></em>, <em class="sig-param"><span class="n">str_in</span></em>, <em class="sig-param"><span class="n">num_eq</span></em>, <em class="sig-param"><span class="n">num_ge</span></em>, <em class="sig-param"><span class="n">num_le</span></em>, <em class="sig-param"><span class="n">num_gt</span></em>, <em class="sig-param"><span class="n">num_lt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#setup_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.setup_filters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mgkit.workflow.filter_gff.validate_params">
<code class="sig-prename descclassname">mgkit.workflow.filter_gff.</code><code class="sig-name descname">validate_params</code><span class="sig-paren">(</span><em class="sig-param">ctx</em>, <em class="sig-param">param</em>, <em class="sig-param">values</em>, <em class="sig-param">convert=&lt;class 'str'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgkit/workflow/filter_gff.html#validate_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mgkit.workflow.filter_gff.validate_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mgkit.workflow.hmmer2gff.html" class="btn btn-neutral float-right" title="mgkit.workflow.hmmer2gff module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mgkit.workflow.fastq_utils.html" class="btn btn-neutral float-left" title="mgkit.workflow.fastq_utils module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2013-2020, Francesco Rubino

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>