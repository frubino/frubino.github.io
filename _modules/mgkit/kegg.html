

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mgkit.kegg &mdash; MGKit: Metagenomic framework 0.5.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MGKit: Metagenomic framework
          

          
          </a>

          
            
            
              <div class="version">
                0.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pipeline/index.html">Metagenomic Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/index.html">Scripts Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gff.html">MGKit GFF Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library.html">Library Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MGKit: Metagenomic framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../mgkit.html">mgkit</a> &raquo;</li>
        
      <li>mgkit.kegg</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mgkit.kegg</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module containing classes and functions to access Kegg data</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">object</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="kn">import</span> <span class="n">viewitems</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">dictionary</span> <span class="k">as</span> <span class="n">dict_utils</span>
<span class="kn">from</span> <span class="nn">.net</span> <span class="kn">import</span> <span class="n">url_read</span>
<span class="kn">from</span> <span class="nn">.io</span> <span class="kn">import</span> <span class="n">open_file</span>


<span class="n">LOG</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">KEGG_REST_URL</span> <span class="o">=</span> <span class="s1">&#39;http://rest.kegg.jp/&#39;</span>


<div class="viewcode-block" id="KeggClientRest"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest">[docs]</a><span class="k">class</span> <span class="nc">KeggClientRest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. versionchanged:: 0.3.1</span>
<span class="sd">        added a *cache* attribute for some methods</span>

<span class="sd">    Kegg REST client</span>

<span class="sd">    The class includes methods and data to use the REST API provided by Kegg.</span>
<span class="sd">    At the moment it provides methods to for &#39;link&#39;, &#39;list&#39; and &#39;get&#39;</span>
<span class="sd">    operations,</span>

<span class="sd">    `Kegg REST API &lt;http://www.kegg.jp/kegg/rest/keggapi.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">contact</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">api_url</span> <span class="o">=</span> <span class="n">KEGG_REST_URL</span>
    <span class="n">cpd_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;ENTRY\s+(C\d</span><span class="si">{5}</span><span class="s2">)\s+Compound\nNAME\s+([,.\w+ ()-]+);?&quot;</span>
    <span class="p">)</span>
    <span class="n">rn_name_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R\d</span><span class="si">{5}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">rn_eq_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C\d</span><span class="si">{5}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ko_desc_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;ko:(K\d</span><span class="si">{5}</span><span class="s2">)\t.+?;\s+([\w+, ()/:&#39;\[\]-]+)( \[EC:)?\n?&quot;</span>
    <span class="p">)</span>
    <span class="n">cpd_desc_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;cpd:(C\d</span><span class="si">{5}</span><span class="s2">)\t([\w+, ()\[\]&#39;*.-]+);?\n?&quot;</span>
    <span class="p">)</span>
    <span class="n">id_prefix</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="s1">&#39;cpd&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="s1">&#39;rn&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="s1">&#39;path&#39;</span><span class="p">}</span>

    <span class="n">cache</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.1</span>

<span class="sd">        The &quot;cache&quot; parameter is a file name for the cached data wrote using</span>
<span class="sd">        :meth:`KeggClientRest.write_cache`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_cache</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>

<div class="viewcode-block" id="KeggClientRest.empty_cache"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.empty_cache">[docs]</a>    <span class="k">def</span> <span class="nf">empty_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.1</span>

<span class="sd">        Empties the cache completely or for a specific method(s)</span>

<span class="sd">        Arguments:</span>
<span class="sd">            methods (iterable, str): string or iterable of strings that are</span>
<span class="sd">                part of the cache. If None the cache is fully emptied</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">methods</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">methods</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;link_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;get_entry&#39;</span><span class="p">,</span> <span class="s1">&#39;get_ids_names&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">methods</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="KeggClientRest.load_cache"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.load_cache">[docs]</a>    <span class="k">def</span> <span class="nf">load_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_handle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.1</span>

<span class="sd">        Loads the cache from file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">open_file</span><span class="p">(</span><span class="n">file_handle</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="KeggClientRest.write_cache"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.write_cache">[docs]</a>    <span class="k">def</span> <span class="nf">write_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_handle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.1</span>

<span class="sd">        Write the cache to file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="n">open_file</span><span class="p">(</span><span class="n">file_handle</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span></div>

    <span class="c1"># Kegg primitives #</span>

<div class="viewcode-block" id="KeggClientRest.link_ids"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.link_ids">[docs]</a>    <span class="k">def</span> <span class="nf">link_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">kegg_ids</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionchanged:: 0.3.1</span>
<span class="sd">            removed *strip* and cached the results</span>

<span class="sd">        The method abstract the use of the &#39;link&#39; operation in the Kegg API</span>

<span class="sd">        The target parameter can be one of the following::</span>

<span class="sd">            pathway | brite | module | disease | drug | environ | ko | genome |</span>
<span class="sd">            &lt;org&gt; | compound | glycan | reaction | rpair | rclass | enzyme</span>

<span class="sd">            &lt;org&gt; = KEGG organism code or T number</span>

<span class="sd">        :param str target: the target db</span>
<span class="sd">        :param ids: can be either a single id as a string or a list of ids</span>
<span class="sd">        :param bool strip: if the prefix (e.g. ko:K00601) should be stripped</span>
<span class="sd">        :param int max_len: the maximum number of ids to retrieve with each</span>
<span class="sd">            request, should not exceed 50</span>
<span class="sd">        :return dict: dictionary mapping requested id to target id(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">kegg_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">kegg_ids</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="n">kegg_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;link_ids&#39;</span><span class="p">][</span><span class="n">target</span><span class="p">]</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Cached Call&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Empty Cache&#39;</span><span class="p">)</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;link_ids&#39;</span><span class="p">][</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapping</span>

        <span class="n">download_ids</span> <span class="o">=</span> <span class="n">kegg_ids</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s1">&#39;Number of cached items (</span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">download_ids</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">while</span> <span class="n">download_ids</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sample_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">download_ids</span><span class="p">,</span> <span class="n">max_len</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1"># download_ids size is less than max_len</span>
                <span class="n">sample_ids</span> <span class="o">=</span> <span class="n">download_ids</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_len</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Downloading links - </span><span class="si">%d</span><span class="s2"> out of </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">download_ids</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">kegg_ids</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">link/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sample_ids</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">source</span><span class="p">,</span> <span class="n">linked</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">linked</span> <span class="o">=</span> <span class="n">linked</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">mapping</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linked</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">mapping</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">linked</span><span class="p">]</span>

            <span class="n">download_ids</span> <span class="o">=</span> <span class="n">download_ids</span> <span class="o">-</span> <span class="n">sample_ids</span>

        <span class="c1"># Empty (Not Found) elements, set to None</span>
        <span class="k">for</span> <span class="n">kegg_id</span> <span class="ow">in</span> <span class="n">kegg_ids</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">mapping</span><span class="p">):</span>
            <span class="n">mapping</span><span class="p">[</span><span class="n">kegg_id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="n">kegg_id</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">kegg_id</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">viewitems</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">kegg_id</span> <span class="ow">in</span> <span class="n">kegg_ids</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="KeggClientRest.list_ids"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.list_ids">[docs]</a>    <span class="k">def</span> <span class="nf">list_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method abstract the use of the &#39;list&#39; operation in the Kegg API</span>

<span class="sd">        The k_id parameter can be one of the following::</span>

<span class="sd">            pathway | brite | module | disease | drug | environ | ko | genome |</span>
<span class="sd">            &lt;org&gt; | compound | glycan | reaction | rpair | rclass | enzyme</span>

<span class="sd">            &lt;org&gt; = KEGG organism code or T number</span>

<span class="sd">        :param str k_id: kegg database to get list of ids</span>
<span class="sd">        :return list: list of ids in the specified database</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">list/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="n">k_id</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>
        <span class="c1"># leave out the last \n</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="KeggClientRest.get_entry"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.get_entry">[docs]</a>    <span class="k">def</span> <span class="nf">get_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k_id</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionchanged:: 0.3.1</span>
<span class="sd">            this is now cached</span>

<span class="sd">        The method abstract the use of the &#39;get&#39; operation in the Kegg API</span>

<span class="sd">        :param str k_id: kegg id of the resource to get</span>
<span class="sd">        :param str option: optional, to specify a format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;get_entry&#39;</span><span class="p">][(</span><span class="n">k_id</span><span class="p">,</span> <span class="n">option</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">get/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span>
                <span class="n">k_id</span><span class="p">,</span>
                <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">option</span>
            <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;get_entry&#39;</span><span class="p">][(</span><span class="n">k_id</span><span class="p">,</span> <span class="n">option</span><span class="p">)]</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="KeggClientRest.link"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.link">[docs]</a>    <span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.2.0</span>

<span class="sd">        Implements &quot;link&quot; operation in Kegg REST</span>

<span class="sd">        http://www.genome.jp/linkdb/</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://rest.genome.jp/link/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">target</span><span class="p">,</span>
            <span class="n">source</span><span class="p">,</span>
            <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">options</span>
        <span class="p">)</span>

        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>

        <span class="n">mappings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">source_id</span><span class="p">,</span> <span class="n">target_id</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">source_id</span> <span class="o">=</span> <span class="n">source_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">target_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mappings</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target_id</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">mappings</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">target_id</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">mappings</span></div>

<div class="viewcode-block" id="KeggClientRest.find"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.1</span>

<span class="sd">        Kegg Help:</span>

<span class="sd">        http://rest.kegg.jp/find/&lt;database&gt;/&lt;query&gt;</span>

<span class="sd">        &lt;database&gt; = pathway | module | ko | genome | &lt;org&gt; | compound | glycan |</span>
<span class="sd">                     reaction | rclass | enzyme | disease | drug | dgroup | environ |</span>
<span class="sd">                     genes | ligand</span>

<span class="sd">        &lt;org&gt; = KEGG organism code or T number</span>

<span class="sd">        http://rest.kegg.jp/find/&lt;database&gt;/&lt;query&gt;/&lt;option&gt;</span>

<span class="sd">        &lt;database&gt; = compound | drug</span>
<span class="sd">        &lt;option&gt; = formula | exact_mass | mol_weight</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; kc = KeggClientRest()</span>
<span class="sd">            &gt;&gt;&gt; kc.find(&#39;CH4&#39;, &#39;compound&#39;)</span>
<span class="sd">            {&#39;C01438&#39;: &#39;Methane; CH4&#39;}</span>
<span class="sd">            &gt;&gt;&gt; kc.find(&#39;K00844&#39;, &#39;genes&#39;, strip=False)</span>
<span class="sd">            {&#39;tped:TPE_0072&#39;: &#39;hexokinase; K00844 hexokinase [EC:2.7.1.1]&#39;,</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; kc.find(&#39;174.05&#39;, &#39;compound&#39;, options=&#39;exact_mass&#39;)</span>
<span class="sd">            {&#39;C00493&#39;: &#39;174.052823&#39;,</span>
<span class="sd">             &#39;C04236&#39;: &#39;174.052823&#39;,</span>
<span class="sd">             &#39;C16588&#39;: &#39;174.052823&#39;,</span>
<span class="sd">             &#39;C17696&#39;: &#39;174.052823&#39;,</span>
<span class="sd">             &#39;C18307&#39;: &#39;174.052823&#39;,</span>
<span class="sd">             &#39;C18312&#39;: &#39;174.052823&#39;,</span>
<span class="sd">             &#39;C21281&#39;: &#39;174.052823&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://rest.kegg.jp/find/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">database</span><span class="p">,</span>
            <span class="n">query</span><span class="p">,</span>
            <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">options</span>
        <span class="p">)</span>

        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>

        <span class="n">mappings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">target_id</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">strip</span><span class="p">:</span>
                <span class="n">target_id</span> <span class="o">=</span> <span class="n">target_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">mappings</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">return</span> <span class="n">mappings</span></div>

<div class="viewcode-block" id="KeggClientRest.conv"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.conv">[docs]</a>    <span class="k">def</span> <span class="nf">conv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_db</span><span class="p">,</span> <span class="n">source_db</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.1</span>

<span class="sd">        Kegg Help:</span>

<span class="sd">        http://rest.kegg.jp/conv/&lt;target_db&gt;/&lt;source_db&gt;</span>

<span class="sd">        (&lt;target_db&gt; &lt;source_db&gt;) = (&lt;kegg_db&gt; &lt;outside_db&gt;) | (&lt;outside_db&gt; &lt;kegg_db&gt;)</span>

<span class="sd">        For gene identifiers:</span>
<span class="sd">        &lt;kegg_db&gt; = &lt;org&gt;</span>
<span class="sd">        &lt;org&gt; = KEGG organism code or T number</span>
<span class="sd">        &lt;outside_db&gt; = ncbi-proteinid | ncbi-geneid | uniprot</span>

<span class="sd">        For chemical substance identifiers:</span>
<span class="sd">        &lt;kegg_db&gt; = drug | compound | glycan</span>
<span class="sd">        &lt;outside_db&gt; = pubchem | chebi</span>
<span class="sd">        http://rest.kegg.jp/conv/&lt;target_db&gt;/&lt;dbentries&gt;</span>

<span class="sd">        For gene identifiers:</span>
<span class="sd">        &lt;dbentries&gt; = database entries involving the following &lt;database&gt;</span>
<span class="sd">        &lt;database&gt; = &lt;org&gt; | genes | ncbi-proteinid | ncbi-geneid | uniprot</span>
<span class="sd">        &lt;org&gt; = KEGG organism code or T number</span>

<span class="sd">        For chemical substance identifiers:</span>
<span class="sd">        &lt;dbentries&gt; = database entries involving the following &lt;database&gt;</span>
<span class="sd">        &lt;database&gt; = drug | compound | glycan | pubchem | chebi</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; kc = KeggClientRest()</span>
<span class="sd">            &gt;&gt;&gt; kc.conv(&#39;ncbi-geneid&#39;, &#39;eco&#39;)</span>
<span class="sd">            {&#39;eco:b0217&#39;: {&#39;ncbi-geneid:949009&#39;},</span>
<span class="sd">             &#39;eco:b0216&#39;: {&#39;ncbi-geneid:947541&#39;},</span>
<span class="sd">             &#39;eco:b0215&#39;: {&#39;ncbi-geneid:946441&#39;},</span>
<span class="sd">             &#39;eco:b0214&#39;: {&#39;ncbi-geneid:946955&#39;},</span>
<span class="sd">             &#39;eco:b0213&#39;: {&#39;ncbi-geneid:944903&#39;},</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; kc.conv(&#39;ncbi-proteinid&#39;, &#39;hsa:10458+ece:Z5100&#39;)</span>
<span class="sd">            {&#39;10458&#39;: {&#39;NP_059345&#39;}, &#39;Z5100&#39;: {&#39;AAG58814&#39;}}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://rest.kegg.jp/conv/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">target_db</span><span class="p">,</span>
            <span class="n">source_db</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>

        <span class="n">mappings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">source_id</span><span class="p">,</span> <span class="n">target_id</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">strip</span><span class="p">:</span>
                <span class="n">target_id</span> <span class="o">=</span> <span class="n">target_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">source_id</span> <span class="o">=</span> <span class="n">source_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">mappings</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target_id</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">mappings</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">target_id</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">mappings</span></div>

    <span class="c1"># names #</span>

<div class="viewcode-block" id="KeggClientRest.get_ids_names"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.get_ids_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_ids_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.1.13</span>

<span class="sd">        .. versionchanged:: 0.3.1</span>
<span class="sd">            the call is now cached</span>

<span class="sd">        Returns a dictionary with the names/description of all the id of a</span>
<span class="sd">        specific target, (ko, path, cpd, etc.)</span>

<span class="sd">        If strip=True the id will stripped of the module abbreviation (e.g.</span>
<span class="sd">        md:M00002-&gt;M00002)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">strip</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;get_ids_names&#39;</span><span class="p">][</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No cached values for &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

        <span class="n">id_names</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_ids</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">kegg_id</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">strip</span><span class="p">:</span>
                <span class="n">kegg_id</span> <span class="o">=</span> <span class="n">kegg_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">id_names</span><span class="p">[</span><span class="n">kegg_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">if</span> <span class="n">strip</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;get_ids_names&#39;</span><span class="p">][</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">id_names</span></div>

<div class="viewcode-block" id="KeggClientRest.get_ortholog_pathways"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.get_ortholog_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">get_ortholog_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets ortholog pathways, replace &#39;map&#39; with &#39;ko&#39; in the id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ids_names</span><span class="p">(</span><span class="s1">&#39;pathway&#39;</span><span class="p">)</span>
        <span class="n">pathways</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">kegg_id</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">viewitems</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>

            <span class="n">kegg_id</span> <span class="o">=</span> <span class="n">kegg_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
            <span class="n">pathways</span><span class="p">[</span><span class="n">kegg_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">return</span> <span class="n">pathways</span></div>

    <span class="c1"># end names #</span>

<div class="viewcode-block" id="KeggClientRest.get_reaction_equations"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.get_reaction_equations">[docs]</a>    <span class="k">def</span> <span class="nf">get_reaction_equations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="s2">&quot;Get the equation for the reactions&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">),</span> <span class="n">max_len</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_len</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Downloading reactions equations - range </span><span class="si">%d</span><span class="s2">-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">max_len</span><span class="p">)</span>

            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">get/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="n">max_len</span><span class="p">])</span>
            <span class="p">)</span>

            <span class="n">t_data</span> <span class="o">=</span> <span class="n">url_read</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">t_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;///&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;EQUATION&#39;</span><span class="p">):</span>
                        <span class="n">cp_in</span><span class="p">,</span> <span class="n">cp_out</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&lt;=&gt;&#39;</span><span class="p">)</span>
                        <span class="c1"># print cp_in, cp_out</span>
                        <span class="n">cp_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rn_eq_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">cp_in</span><span class="p">)</span>
                        <span class="n">cp_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rn_eq_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">cp_out</span><span class="p">)</span>
                        <span class="c1"># print cp_in, cp_out</span>
                    <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ENTRY&#39;</span><span class="p">):</span>
                        <span class="c1"># try:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rn_name_re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="c1"># except:</span>
                        <span class="c1">#     print line</span>
                <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;in&#39;</span><span class="p">:</span> <span class="n">cp_in</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span> <span class="n">cp_out</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="KeggClientRest.get_pathway_links"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggClientRest.get_pathway_links">[docs]</a>    <span class="k">def</span> <span class="nf">get_pathway_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathway</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary with the mappings KO-&gt;compounds for a specific</span>
<span class="sd">        Pathway or module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">compounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_ids</span><span class="p">(</span><span class="s1">&#39;cpd&#39;</span><span class="p">,</span> <span class="n">pathway</span><span class="p">)</span>
        <span class="n">compounds</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">compounds</span><span class="p">[</span><span class="n">pathway</span><span class="p">])</span>
        <span class="n">kos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_ids</span><span class="p">(</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">pathway</span><span class="p">)</span>
        <span class="n">kos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kos</span><span class="p">[</span><span class="n">pathway</span><span class="p">])</span>
        <span class="n">cp_rn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_ids</span><span class="p">(</span><span class="s1">&#39;ec&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">compounds</span><span class="p">))</span>
        <span class="n">ko_rn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_ids</span><span class="p">(</span><span class="s1">&#39;ec&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">kos</span><span class="p">))</span>
        <span class="n">cp_rn_rev</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">reverse_mapping</span><span class="p">(</span><span class="n">cp_rn</span><span class="p">)</span>
        <span class="n">ko_cp</span> <span class="o">=</span> <span class="n">dict_utils</span><span class="o">.</span><span class="n">combine_dict</span><span class="p">(</span><span class="n">ko_rn</span><span class="p">,</span> <span class="n">cp_rn_rev</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ko_cp</span></div></div>


<span class="n">BLACK_LIST</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ko05164&#39;</span><span class="p">,</span>  <span class="c1"># Influenza A</span>
    <span class="s1">&#39;ko05166&#39;</span><span class="p">,</span>  <span class="c1"># HTLV-I infection</span>
    <span class="s1">&#39;ko05161&#39;</span><span class="p">,</span>  <span class="c1"># Hepatitis B</span>
    <span class="s1">&#39;ko05160&#39;</span><span class="p">,</span>  <span class="c1"># Hepatitis C</span>
    <span class="s1">&#39;ko05162&#39;</span><span class="p">,</span>  <span class="c1"># Measles</span>
    <span class="s1">&#39;ko05169&#39;</span><span class="p">,</span>  <span class="c1"># Epstein-Barr virus infection</span>
    <span class="s1">&#39;ko05168&#39;</span><span class="p">,</span>  <span class="c1"># Herpes simplex infection</span>
    <span class="s1">&#39;ko04520&#39;</span><span class="p">,</span>  <span class="c1"># Adherens junction</span>
    <span class="s1">&#39;ko05014&#39;</span><span class="p">,</span>  <span class="c1"># Amyotrophic lateral sclerosis (ALS)</span>
    <span class="s1">&#39;ko05016&#39;</span><span class="p">,</span>  <span class="c1"># Huntington&#39;s disease</span>
    <span class="s1">&#39;ko05310&#39;</span><span class="p">,</span>  <span class="c1"># Asthma</span>
    <span class="s1">&#39;ko00908&#39;</span><span class="p">,</span>  <span class="c1"># Zeatin biosynthesis</span>
    <span class="s1">&#39;ko04930&#39;</span><span class="p">,</span>  <span class="c1"># Type II diabetes mellitus</span>
    <span class="s1">&#39;ko04622&#39;</span><span class="p">,</span>  <span class="c1"># RIG-I-like receptor signaling pathway</span>
    <span class="s1">&#39;ko04626&#39;</span><span class="p">,</span>  <span class="c1"># Plant-pathogen interaction</span>
    <span class="s1">&#39;ko05222&#39;</span><span class="p">,</span>  <span class="c1"># Small cell lung cancer</span>
    <span class="s1">&#39;ko05223&#39;</span><span class="p">,</span>  <span class="c1"># Non-small cell lung cancer</span>
    <span class="s1">&#39;ko05220&#39;</span><span class="p">,</span>  <span class="c1"># Chronic myeloid leukemia</span>
    <span class="s1">&#39;ko05221&#39;</span><span class="p">,</span>  <span class="c1"># Acute myeloid leukemia</span>
    <span class="s1">&#39;ko04612&#39;</span><span class="p">,</span>  <span class="c1"># Antigen processing and presentation</span>
    <span class="s1">&#39;ko04621&#39;</span><span class="p">,</span>  <span class="c1"># NOD-like receptor signaling pathway</span>
    <span class="s1">&#39;ko04620&#39;</span><span class="p">,</span>  <span class="c1"># Toll-like receptor signaling pathway</span>
    <span class="s1">&#39;ko04623&#39;</span><span class="p">,</span>  <span class="c1"># Cytosolic DNA-sensing pathway</span>
    <span class="s1">&#39;ko04622&#39;</span><span class="p">,</span>  <span class="c1"># RIG-I-like receptor signaling pathway</span>
    <span class="s1">&#39;ko00351&#39;</span><span class="p">,</span>  <span class="c1"># DDT degradation</span>
    <span class="s1">&#39;ko04270&#39;</span><span class="p">,</span>  <span class="c1"># Vascular smooth muscle contraction</span>
    <span class="s1">&#39;ko04115&#39;</span><span class="p">,</span>  <span class="c1"># p53 signaling pathway</span>
    <span class="s1">&#39;ko04114&#39;</span><span class="p">,</span>  <span class="c1"># Oocyte meiosis</span>
    <span class="s1">&#39;ko05120&#39;</span><span class="p">,</span>  <span class="c1"># Epithelial cell signaling in Helicobacter pylori infection</span>
    <span class="s1">&#39;ko00590&#39;</span><span class="p">,</span>  <span class="c1"># Arachidonic acid metabolism</span>
    <span class="s1">&#39;ko04370&#39;</span><span class="p">,</span>  <span class="c1"># VEGF signaling pathway</span>
    <span class="s1">&#39;ko04976&#39;</span><span class="p">,</span>  <span class="c1"># Bile secretion</span>
    <span class="s1">&#39;ko04971&#39;</span><span class="p">,</span>  <span class="c1"># Gastric acid secretion</span>
    <span class="s1">&#39;ko04970&#39;</span><span class="p">,</span>  <span class="c1"># Salivary secretion</span>
    <span class="s1">&#39;ko04973&#39;</span><span class="p">,</span>  <span class="c1"># Carbohydrate digestion and absorption</span>
    <span class="s1">&#39;ko04972&#39;</span><span class="p">,</span>  <span class="c1"># Pancreatic secretion</span>
    <span class="s1">&#39;ko04975&#39;</span><span class="p">,</span>  <span class="c1"># Fat digestion and absorption</span>
    <span class="s1">&#39;ko04974&#39;</span><span class="p">,</span>  <span class="c1"># Protein digestion and absorption</span>
    <span class="s1">&#39;ko04977&#39;</span><span class="p">,</span>  <span class="c1"># Vitamin digestion and absorption</span>
    <span class="s1">&#39;ko04711&#39;</span><span class="p">,</span>  <span class="c1"># Circadian rhythm - fly</span>
    <span class="s1">&#39;ko04710&#39;</span><span class="p">,</span>  <span class="c1"># Circadian rhythm</span>
    <span class="s1">&#39;ko04713&#39;</span><span class="p">,</span>  <span class="c1"># Circadian entrainment</span>
    <span class="s1">&#39;ko04712&#39;</span><span class="p">,</span>  <span class="c1"># Circadian rhythm - plant</span>
    <span class="s1">&#39;ko04650&#39;</span><span class="p">,</span>  <span class="c1"># Natural killer cell mediated cytotoxicity</span>
    <span class="s1">&#39;ko04391&#39;</span><span class="p">,</span>  <span class="c1"># Hippo signaling pathway - fly</span>
    <span class="s1">&#39;ko04151&#39;</span><span class="p">,</span>  <span class="c1"># PI3K-Akt signaling pathway</span>
    <span class="s1">&#39;ko04150&#39;</span><span class="p">,</span>  <span class="c1"># mTOR signaling pathway</span>
    <span class="s1">&#39;ko04510&#39;</span><span class="p">,</span>  <span class="c1"># Focal adhesion</span>
    <span class="s1">&#39;ko04012&#39;</span><span class="p">,</span>  <span class="c1"># ErbB signaling pathway</span>
    <span class="s1">&#39;ko04013&#39;</span><span class="p">,</span>  <span class="c1"># MAPK signaling pathway - fly</span>
    <span class="s1">&#39;ko04010&#39;</span><span class="p">,</span>  <span class="c1"># MAPK signaling pathway</span>
    <span class="s1">&#39;ko03320&#39;</span><span class="p">,</span>  <span class="c1"># PPAR signaling pathway</span>
    <span class="s1">&#39;ko04530&#39;</span><span class="p">,</span>  <span class="c1"># Tight junction</span>
    <span class="s1">&#39;ko00981&#39;</span><span class="p">,</span>  <span class="c1"># Insect hormone biosynthesis</span>
    <span class="s1">&#39;ko00982&#39;</span><span class="p">,</span>  <span class="c1"># Drug metabolism - cytochrome P450</span>
    <span class="s1">&#39;ko00983&#39;</span><span class="p">,</span>  <span class="c1"># Drug metabolism - other enzymes</span>
    <span class="s1">&#39;ko05150&#39;</span><span class="p">,</span>  <span class="c1"># Staphylococcus aureus infection</span>
    <span class="s1">&#39;ko05152&#39;</span><span class="p">,</span>  <span class="c1"># Tuberculosis</span>
    <span class="s1">&#39;ko04614&#39;</span><span class="p">,</span>  <span class="c1"># Renin-angiotensin system</span>
    <span class="s1">&#39;ko04610&#39;</span><span class="p">,</span>  <span class="c1"># Complement and coagulation cascades</span>
    <span class="s1">&#39;ko04340&#39;</span><span class="p">,</span>  <span class="c1"># Hedgehog signaling pathway</span>
    <span class="s1">&#39;ko00984&#39;</span><span class="p">,</span>  <span class="c1"># Steroid degradation</span>
    <span class="s1">&#39;ko05010&#39;</span><span class="p">,</span>  <span class="c1"># Alzheimer&#39;s disease</span>
    <span class="s1">&#39;ko05012&#39;</span><span class="p">,</span>  <span class="c1"># Parkinson&#39;s disease</span>
    <span class="s1">&#39;ko04260&#39;</span><span class="p">,</span>  <span class="c1"># Cardiac muscle contraction</span>
    <span class="s1">&#39;ko04540&#39;</span><span class="p">,</span>  <span class="c1"># Gap junction</span>
    <span class="s1">&#39;ko05110&#39;</span><span class="p">,</span>  <span class="c1"># Vibrio cholerae infection</span>
    <span class="s1">&#39;ko05111&#39;</span><span class="p">,</span>  <span class="c1"># Vibrio cholerae pathogenic cycle</span>
    <span class="s1">&#39;ko04640&#39;</span><span class="p">,</span>  <span class="c1"># Hematopoietic cell lineage</span>
    <span class="s1">&#39;ko04310&#39;</span><span class="p">,</span>  <span class="c1"># Wnt signaling pathway</span>
    <span class="s1">&#39;ko04728&#39;</span><span class="p">,</span>  <span class="c1"># Dopaminergic synapse</span>
    <span class="s1">&#39;ko04724&#39;</span><span class="p">,</span>  <span class="c1"># Glutamatergic synapse</span>
    <span class="s1">&#39;ko04725&#39;</span><span class="p">,</span>  <span class="c1"># Cholinergic synapse</span>
    <span class="s1">&#39;ko04726&#39;</span><span class="p">,</span>  <span class="c1"># Serotonergic synapse</span>
    <span class="s1">&#39;ko04727&#39;</span><span class="p">,</span>  <span class="c1"># GABAergic synapse</span>
    <span class="s1">&#39;ko04720&#39;</span><span class="p">,</span>  <span class="c1"># Long-term potentiation</span>
    <span class="s1">&#39;ko04721&#39;</span><span class="p">,</span>  <span class="c1"># Synaptic vesicle cycle</span>
    <span class="s1">&#39;ko04722&#39;</span><span class="p">,</span>  <span class="c1"># Neurotrophin signaling pathway</span>
    <span class="s1">&#39;ko04723&#39;</span><span class="p">,</span>  <span class="c1"># Retrograde endocannabinoid signaling</span>
    <span class="s1">&#39;ko05340&#39;</span><span class="p">,</span>  <span class="c1"># Primary immunodeficiency</span>
    <span class="s1">&#39;ko05414&#39;</span><span class="p">,</span>  <span class="c1"># Dilated cardiomyopathy</span>
    <span class="s1">&#39;ko05416&#39;</span><span class="p">,</span>  <span class="c1"># Viral myocarditis</span>
    <span class="s1">&#39;ko05410&#39;</span><span class="p">,</span>  <span class="c1"># Hypertrophic cardiomyopathy (HCM)</span>
    <span class="s1">&#39;ko05412&#39;</span><span class="p">,</span>  <span class="c1"># Arrhythmogenic right ventricular cardiomyopathy (ARVC)</span>
    <span class="s1">&#39;ko04130&#39;</span><span class="p">,</span>  <span class="c1"># SNARE interactions in vesicular transport</span>
    <span class="s1">&#39;ko05145&#39;</span><span class="p">,</span>  <span class="c1"># Toxoplasmosis</span>
    <span class="s1">&#39;ko05144&#39;</span><span class="p">,</span>  <span class="c1"># Malaria</span>
    <span class="s1">&#39;ko04350&#39;</span><span class="p">,</span>  <span class="c1"># TGF-beta signaling pathway</span>
    <span class="s1">&#39;ko04210&#39;</span><span class="p">,</span>  <span class="c1"># Apoptosis</span>
    <span class="s1">&#39;ko05200&#39;</span><span class="p">,</span>  <span class="c1"># Pathways in cancer</span>
    <span class="s1">&#39;ko05202&#39;</span><span class="p">,</span>  <span class="c1"># Transcriptional misregulation in cancer</span>
    <span class="s1">&#39;ko05203&#39;</span><span class="p">,</span>  <span class="c1"># Viral carcinogenesis</span>
    <span class="s1">&#39;ko05020&#39;</span><span class="p">,</span>  <span class="c1"># Prion diseases</span>
    <span class="s1">&#39;ko05143&#39;</span><span class="p">,</span>  <span class="c1"># African trypanosomiasis</span>
    <span class="s1">&#39;ko05142&#39;</span><span class="p">,</span>  <span class="c1"># Chagas disease (American trypanosomiasis)</span>
    <span class="s1">&#39;ko05140&#39;</span><span class="p">,</span>  <span class="c1"># Leishmaniasis</span>
    <span class="s1">&#39;ko00072&#39;</span><span class="p">,</span>  <span class="c1"># Synthesis and degradation of ketone bodies</span>
    <span class="s1">&#39;ko00073&#39;</span><span class="p">,</span>  <span class="c1"># Cutin, suberine and wax biosynthesis</span>
    <span class="s1">&#39;ko05330&#39;</span><span class="p">,</span>  <span class="c1"># Allograft rejection</span>
    <span class="s1">&#39;ko04912&#39;</span><span class="p">,</span>  <span class="c1"># GnRH signaling pathway</span>
    <span class="s1">&#39;ko05332&#39;</span><span class="p">,</span>  <span class="c1"># Graft-versus-host disease</span>
    <span class="s1">&#39;ko04910&#39;</span><span class="p">,</span>  <span class="c1"># Insulin signaling pathway</span>
    <span class="s1">&#39;ko04916&#39;</span><span class="p">,</span>  <span class="c1"># Melanogenesis</span>
    <span class="s1">&#39;ko04914&#39;</span><span class="p">,</span>  <span class="c1"># Progesterone-mediated oocyte maturation</span>
    <span class="s1">&#39;ko04672&#39;</span><span class="p">,</span>  <span class="c1"># Intestinal immune network for IgA production</span>
    <span class="s1">&#39;ko04670&#39;</span><span class="p">,</span>  <span class="c1"># Leukocyte transendothelial migration</span>
    <span class="s1">&#39;ko04660&#39;</span><span class="p">,</span>  <span class="c1"># T cell receptor signaling pathway</span>
    <span class="s1">&#39;ko00603&#39;</span><span class="p">,</span>  <span class="c1"># Glycosphingolipid biosynthesis - globo series</span>
    <span class="s1">&#39;ko00601&#39;</span><span class="p">,</span>  <span class="c1"># Glycosphingolipid biosynthesis - lacto and neolacto series</span>
    <span class="s1">&#39;ko00600&#39;</span><span class="p">,</span>  <span class="c1"># Sphingolipid metabolism</span>
    <span class="s1">&#39;ko00604&#39;</span><span class="p">,</span>  <span class="c1"># Glycosphingolipid biosynthesis - ganglio series</span>
    <span class="s1">&#39;ko04070&#39;</span><span class="p">,</span>  <span class="c1"># Phosphatidylinositol signaling system</span>
    <span class="s1">&#39;ko04075&#39;</span><span class="p">,</span>  <span class="c1"># Plant hormone signal transduction</span>
    <span class="s1">&#39;ko05100&#39;</span><span class="p">,</span>  <span class="c1"># Bacterial invasion of epithelial cells</span>
    <span class="s1">&#39;ko05204&#39;</span><span class="p">,</span>  <span class="c1"># Chemical carcinogenesis</span>
    <span class="s1">&#39;ko04920&#39;</span><span class="p">,</span>  <span class="c1"># Adipocytokine signaling pathway</span>
    <span class="s1">&#39;ko04080&#39;</span><span class="p">,</span>  <span class="c1"># Neuroactive ligand-receptor interaction</span>
    <span class="s1">&#39;ko04320&#39;</span><span class="p">,</span>  <span class="c1"># Dorso-ventral axis formation</span>
    <span class="s1">&#39;ko04730&#39;</span><span class="p">,</span>  <span class="c1"># Long-term depression</span>
    <span class="s1">&#39;ko04950&#39;</span><span class="p">,</span>  <span class="c1"># Maturity onset diabetes of the young</span>
    <span class="s1">&#39;ko04630&#39;</span><span class="p">,</span>  <span class="c1"># Jak-STAT signaling pathway</span>
    <span class="s1">&#39;ko04742&#39;</span><span class="p">,</span>  <span class="c1"># Taste transduction</span>
    <span class="s1">&#39;ko04740&#39;</span><span class="p">,</span>  <span class="c1"># Olfactory transduction</span>
    <span class="s1">&#39;ko04744&#39;</span><span class="p">,</span>  <span class="c1"># Phototransduction</span>
    <span class="s1">&#39;ko04745&#39;</span><span class="p">,</span>  <span class="c1"># Phototransduction - fly</span>
    <span class="s1">&#39;ko04512&#39;</span><span class="p">,</span>  <span class="c1"># ECM-receptor interaction</span>
    <span class="s1">&#39;ko03460&#39;</span><span class="p">,</span>  <span class="c1"># Fanconi anemia pathway</span>
    <span class="s1">&#39;ko04360&#39;</span><span class="p">,</span>  <span class="c1"># Axon guidance</span>
    <span class="s1">&#39;ko05219&#39;</span><span class="p">,</span>  <span class="c1"># Bladder cancer</span>
    <span class="s1">&#39;ko05218&#39;</span><span class="p">,</span>  <span class="c1"># Melanoma</span>
    <span class="s1">&#39;ko05217&#39;</span><span class="p">,</span>  <span class="c1"># Basal cell carcinoma</span>
    <span class="s1">&#39;ko05216&#39;</span><span class="p">,</span>  <span class="c1"># Thyroid cancer</span>
    <span class="s1">&#39;ko05215&#39;</span><span class="p">,</span>  <span class="c1"># Prostate cancer</span>
    <span class="s1">&#39;ko05214&#39;</span><span class="p">,</span>  <span class="c1"># Glioma</span>
    <span class="s1">&#39;ko05213&#39;</span><span class="p">,</span>  <span class="c1"># Endometrial cancer</span>
    <span class="s1">&#39;ko05212&#39;</span><span class="p">,</span>  <span class="c1"># Pancreatic cancer</span>
    <span class="s1">&#39;ko05211&#39;</span><span class="p">,</span>  <span class="c1"># Renal cell carcinoma</span>
    <span class="s1">&#39;ko05210&#39;</span><span class="p">,</span>  <span class="c1"># Colorectal cancer</span>
    <span class="s1">&#39;ko05034&#39;</span><span class="p">,</span>  <span class="c1"># Alcoholism</span>
    <span class="s1">&#39;ko05033&#39;</span><span class="p">,</span>  <span class="c1"># Nicotine addiction</span>
    <span class="s1">&#39;ko05032&#39;</span><span class="p">,</span>  <span class="c1"># Morphine addiction</span>
    <span class="s1">&#39;ko05031&#39;</span><span class="p">,</span>  <span class="c1"># Amphetamine addiction</span>
    <span class="s1">&#39;ko05030&#39;</span><span class="p">,</span>  <span class="c1"># Cocaine addiction</span>
    <span class="s1">&#39;ko05134&#39;</span><span class="p">,</span>  <span class="c1"># Legionellosis</span>
    <span class="s1">&#39;ko05132&#39;</span><span class="p">,</span>  <span class="c1"># Salmonella infection</span>
    <span class="s1">&#39;ko05133&#39;</span><span class="p">,</span>  <span class="c1"># Pertussis</span>
    <span class="s1">&#39;ko05130&#39;</span><span class="p">,</span>  <span class="c1"># Pathogenic Escherichia coli infection</span>
    <span class="s1">&#39;ko05131&#39;</span><span class="p">,</span>  <span class="c1"># Shigellosis</span>

    <span class="c1"># Too big</span>
    <span class="s1">&#39;ko01100&#39;</span><span class="p">,</span>  <span class="c1"># Metabolic pathways</span>
    <span class="s1">&#39;ko01110&#39;</span><span class="p">,</span>  <span class="c1"># Biosynthesis of secondary metabolites</span>
    <span class="s1">&#39;ko01120&#39;</span><span class="p">,</span>  <span class="c1"># Microbial metabolism in diverse environments</span>

    <span class="s1">&#39;ko04662&#39;</span><span class="p">,</span>  <span class="c1"># B cell receptor signaling pathway</span>
    <span class="s1">&#39;ko04966&#39;</span><span class="p">,</span>  <span class="c1"># Collecting duct acid secretion</span>
    <span class="s1">&#39;ko05322&#39;</span><span class="p">,</span>  <span class="c1"># Systemic lupus erythematosus</span>
    <span class="s1">&#39;ko04964&#39;</span><span class="p">,</span>  <span class="c1"># Proximal tubule bicarbonate reclamation</span>
    <span class="s1">&#39;ko05320&#39;</span><span class="p">,</span>  <span class="c1"># Autoimmune thyroid disease</span>
    <span class="s1">&#39;ko04962&#39;</span><span class="p">,</span>  <span class="c1"># Vasopressin-regulated water reabsorption</span>
    <span class="s1">&#39;ko04960&#39;</span><span class="p">,</span>  <span class="c1"># Aldosterone-regulated sodium reabsorption</span>
    <span class="s1">&#39;ko04961&#39;</span><span class="p">,</span>  <span class="c1"># Endocrine and other factor-regulated calcium reabsorption</span>
    <span class="s1">&#39;ko04380&#39;</span><span class="p">,</span>  <span class="c1"># Osteoclast differentiation</span>
    <span class="s1">&#39;ko04664&#39;</span><span class="p">,</span>  <span class="c1"># Fc epsilon RI signaling pathway</span>
    <span class="s1">&#39;ko04666&#39;</span><span class="p">,</span>  <span class="c1"># Fc gamma R-mediated phagocytosis</span>
    <span class="s1">&#39;ko04062&#39;</span><span class="p">,</span>  <span class="c1"># Chemokine signaling pathway</span>
    <span class="s1">&#39;ko04060&#39;</span><span class="p">,</span>  <span class="c1"># Cytokine-cytokine receptor interaction</span>
    <span class="s1">&#39;ko04066&#39;</span><span class="p">,</span>  <span class="c1"># HIF-1 signaling pathway</span>
    <span class="s1">&#39;ko04064&#39;</span><span class="p">,</span>  <span class="c1"># NF-kappa B signaling pathway</span>
    <span class="s1">&#39;ko05323&#39;</span><span class="p">,</span>  <span class="c1"># Rheumatoid arthritis</span>
    <span class="s1">&#39;ko00140&#39;</span><span class="p">,</span>  <span class="c1"># Steroid hormone biosynthesis</span>
<span class="p">]</span>


<div class="viewcode-block" id="KeggModule"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggModule">[docs]</a><span class="k">class</span> <span class="nc">KeggModule</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. versionadded:: 0.1.13</span>

<span class="sd">    Used to extract information from a pathway module entry in Kegg</span>

<span class="sd">    The entry, as a string, can be either passed at instance creation or with</span>
<span class="sd">    :meth:`KeggModule.parse_entry`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entry</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">compounds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_orthologs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_reactions</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">reactions</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionchanged:: 0.3.0</span>
<span class="sd">            added *old* parameter, to use the old parser</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">old</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_entry2</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

<div class="viewcode-block" id="KeggModule.parse_entry"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggModule.parse_entry">[docs]</a>    <span class="k">def</span> <span class="nf">parse_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses a Kegg module entry and change the instance values. By default</span>
<span class="sd">        the reactions IDs are substituted with the KO IDs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entryd</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">curr_field</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">):</span>
                <span class="n">entryd</span><span class="p">[</span><span class="n">curr_field</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;///&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">curr_field</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">entryd</span><span class="p">[</span><span class="n">curr_field</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">entryd</span><span class="p">[</span><span class="n">curr_field</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">curr_field</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(M\d</span><span class="si">{5}</span><span class="s2">)\s+.+&quot;</span><span class="p">,</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;ENTRY&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;CLASS&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(C\d</span><span class="si">{5}</span><span class="s2">)\s+.+&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;COMPOUND&#39;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_reaction</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">ko_ids</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ko_ids</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;DEFINITION&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span>
                <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;REACTION&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthologs</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;DEFINITION&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reactions</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;REACTION&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="KeggModule.parse_entry2"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggModule.parse_entry2">[docs]</a>    <span class="k">def</span> <span class="nf">parse_entry2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.0</span>

<span class="sd">        Parses a Kegg module entry and change the instance values. By default</span>
<span class="sd">        the reactions IDs are NOT substituted with the KO IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entryd</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">curr_field</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">):</span>
                <span class="n">entryd</span><span class="p">[</span><span class="n">curr_field</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;///&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">curr_field</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">entryd</span><span class="p">[</span><span class="n">curr_field</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">entryd</span><span class="p">[</span><span class="n">curr_field</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">curr_field</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(M\d</span><span class="si">{5}</span><span class="s2">)\s+.+&quot;</span><span class="p">,</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;ENTRY&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;CLASS&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(C\d</span><span class="si">{5}</span><span class="s2">)\s+.+&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;COMPOUND&#39;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;REACTION&#39;</span><span class="p">]:</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_reaction</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">ko_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_orthologs</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;DEFINITION&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reactions</span> <span class="o">=</span> <span class="n">entryd</span><span class="p">[</span><span class="s1">&#39;REACTION&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="KeggModule.parse_reaction"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggModule.parse_reaction">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_reaction</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">ko_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionchanged:: 0.3.0</span>
<span class="sd">            cleaned the parsing</span>

<span class="sd">        parses the lines with the reactions and substitute reaction IDs with</span>
<span class="sd">        the corresponding KO IDs if provided</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># line = &#39;R00294,R02492,R09446,R09808,R09809  C00533 -&gt; C00887&#39;</span>
        <span class="c1"># ko_ids = &#39;(K00370+K00371+K00374+K00373,K02567+K02568)&#39;</span>
        <span class="c1"># some reaction lines have only one space</span>
        <span class="n">rn_ids</span><span class="p">,</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">rn_ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rn_ids</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="n">comp1</span><span class="p">,</span> <span class="n">comp2</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; -&gt; &#39;</span><span class="p">)</span>
        <span class="n">comp1</span> <span class="o">=</span> <span class="n">comp1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(spontaneous)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">comp2</span> <span class="o">=</span> <span class="n">comp2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(spontaneous)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">comp1</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="n">comp2</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ko_ids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rn_ids</span> <span class="o">=</span> <span class="n">ko_ids</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rn_ids</span><span class="p">,</span> <span class="p">(</span><span class="n">comp1</span><span class="p">,</span> <span class="n">comp2</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">first_cp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Returns the first compound in the module&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">last_cp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Returns the first compound in the module&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="KeggModule.to_edges"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggModule.to_edges">[docs]</a>    <span class="k">def</span> <span class="nf">to_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_only</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionchanged:: 0.3.0</span>
<span class="sd">            added id_only and changed to reflect changes in :attr:`reactions`</span>

<span class="sd">        Returns the reactions as edges that can be supplied to make graph.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            id_only (None, iterable): if None the returned edges are for the</span>
<span class="sd">                whole module, if an iterable (converted to a :class:`set`),</span>
<span class="sd">                only edges for those reactions are returned</span>

<span class="sd">        Yield:</span>
<span class="sd">            tuple: the elements are the compounds and reactions in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">id_only</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">id_only</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">id_only</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">rn_ids</span><span class="p">,</span> <span class="p">(</span><span class="n">comp1s</span><span class="p">,</span> <span class="n">comp2s</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rn_id</span> <span class="ow">in</span> <span class="n">rn_ids</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">id_only</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">rn_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">id_only</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">comp1</span> <span class="ow">in</span> <span class="n">comp1s</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="p">(</span><span class="n">comp1</span><span class="p">,</span> <span class="n">rn_id</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">comp2</span> <span class="ow">in</span> <span class="n">comp2s</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="p">(</span><span class="n">rn_id</span><span class="p">,</span> <span class="n">comp2</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeggModule.find_submodules"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.KeggModule.find_submodules">[docs]</a>    <span class="k">def</span> <span class="nf">find_submodules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionadded:: 0.3.0</span>

<span class="sd">        Returns the possible submodules, as a list of tuples where the elements</span>
<span class="sd">        are the first and last compounds in a submodule</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sub_modules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sub_module</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">rn_ids</span><span class="p">,</span> <span class="p">(</span><span class="n">left_cpds</span><span class="p">,</span> <span class="n">right_cpds</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sub_module</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sub_module</span> <span class="o">=</span> <span class="p">[</span><span class="n">left_cpds</span><span class="p">,</span> <span class="n">right_cpds</span><span class="p">]</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">sub_module</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">left_cpds</span><span class="p">):</span>
                <span class="n">sub_module</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_cpds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sub_modules</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sub_module</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sub_module</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">sub_module</span> <span class="o">=</span> <span class="p">[</span><span class="n">left_cpds</span><span class="p">,</span> <span class="n">right_cpds</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub_modules</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sub_module</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sub_module</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">sub_modules</span></div></div>


<div class="viewcode-block" id="parse_reaction"><a class="viewcode-back" href="../../api/mgkit.kegg.html#mgkit.kegg.parse_reaction">[docs]</a><span class="k">def</span> <span class="nf">parse_reaction</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. versionadded:: 0.3.1</span>

<span class="sd">    Parses a reaction equation from Kegg, returning the left and right</span>
<span class="sd">    components. Needs testing</span>

<span class="sd">    Arguments:</span>
<span class="sd">        line (str): reaction string</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: left and right components as `sets`</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;EQUATION&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;&lt;=&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&lt;=&gt;&#39;</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">))</span>
        <span class="n">right</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
    <span class="k">elif</span> <span class="s1">&#39;=&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt;&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;&lt;=&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&lt;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;???&#39;</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2015, Francesco Rubino

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>